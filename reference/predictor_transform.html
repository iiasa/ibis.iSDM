<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial adjustment of environmental predictors and raster stacks — predictor_transform • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial adjustment of environmental predictors and raster stacks — predictor_transform"><meta name="description" content="This function allows the transformation of provided environmental
predictors (in SpatRaster format). A common use case is for instance the
standardization (or scaling) of all predictors prior to model fitting. This
function works both with SpatRaster as well as with stars objects."><meta property="og:description" content="This function allows the transformation of provided environmental
predictors (in SpatRaster format). A common use case is for instance the
standardization (or scaling) of all predictors prior to model fitting. This
function works both with SpatRaster as well as with stars objects."><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a></li>
    <li><a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a></li>
    <li><a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a></li>
    <li><a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a></li>
    <li><a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a></li>
    <li><a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a></li>
    <li><a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spatial adjustment of environmental predictors and raster stacks</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/dev/R/utils-predictors.R" class="external-link"><code>R/utils-predictors.R</code></a></small>
      <div class="d-none name"><code>predictor_transform.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows the transformation of provided environmental
predictors (in <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> format). A common use case is for instance the
standardization (or scaling) of all predictors prior to model fitting. This
function works both with <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> as well as with <code><a href="https://rdrr.io/r/graphics/stars.html" class="external-link">stars</a></code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predictor_transform</span><span class="op">(</span></span>
<span>  <span class="va">env</span>,</span>
<span>  <span class="va">option</span>,</span>
<span>  windsor_props <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  pca.var <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  state <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>A <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> or <code><a href="https://rdrr.io/r/graphics/stars.html" class="external-link">stars</a></code> object.</p></dd>


<dt id="arg-option">option<a class="anchor" aria-label="anchor" href="#arg-option"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code> stating whether predictors should be preprocessed
in any way (Options: <code>'none'</code>, <code>'scale'</code>, <code>'norm'</code>, <code>'windsor'</code>,
<code>'windsor_thresh'</code>, <code>'percentile'</code> <code>'pca'</code>, <code>'revjack'</code>). See Details.</p></dd>


<dt id="arg-windsor-props">windsor_props<a class="anchor" aria-label="anchor" href="#arg-windsor-props"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> vector specifying the proportions to be
clipped for windsorization (Default: <code>c(.05,.95)</code>).</p></dd>


<dt id="arg-pca-var">pca.var<a class="anchor" aria-label="anchor" href="#arg-pca-var"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> value between <code>&gt;0</code> and <code>1</code> stating the
minimum amount of variance to be covered (Default: <code>0.8</code>).</p></dd>


<dt id="arg-state">state<a class="anchor" aria-label="anchor" href="#arg-state"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> with one value per variable (column) providing either a ( <code>stats::mean()</code>, <code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">stats::sd()</a></code> )
for each variable in <code>env</code> for option <code>'scale'</code> or a range of minimum and maximum values for
option <code>'norm'</code>. Effectively applies their value range for rescaling. (Default: <code>NULL</code>).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>As <code>'option'</code> for more intuitive method setting. Can be left
empty (in this case option has to be set).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other options (Non specified).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a adjusted <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> object of identical resolution.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Available options are:</p><ul><li><p><code>'none'</code> The original layer(s) are returned.</p></li>
<li><p><code>'scale'</code> This run the <code><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale()</a></code> function with default settings
(1 Standard deviation) across all predictors. A sensible default to for most model fitting.</p></li>
<li><p><code>'norm'</code> This normalizes all predictors to a range from <code>0-1</code>.</p></li>
<li><p><code>'windsor'</code> This applies a 'windsorization' to an existing raster layer
by setting the lowest, respectively largest values to the value at a certain
percentage level (e.g. 95%). Those can be set via the parameter <code>"windsor_props"</code>.</p></li>
<li><p><code>'windsor_thresh'</code> Same as option 'windsor', however in this case values
are clamped to a thresholds rather than certain percentages calculated on the data.</p></li>
<li><p><code>'percentile'</code> This converts and bins all values into percentiles, e.g.
the top 10% or lowest 10% of values and so on.</p></li>
<li><p><code>'pca'</code> This option runs a principal component decomposition of all
predictors (via <code><a href="https://rspatial.github.io/terra/reference/prcomp.html" class="external-link">prcomp()</a></code>). It returns new predictors resembling all components
in order of the most important ones. Can be useful to reduce collinearity, however
note that this changes all predictor names to 'PCX', where X is the number of
the component. The parameter <code>'pca.var'</code> can be modified to specify the
minimum variance to be covered by the axes.</p></li>
<li><p><code>'revjack'</code> Removes outliers from the supplied stack via a reverse jackknife
procedure. Identified outliers are by default set to <code>NA</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If future covariates are rescaled or normalized, it is highly recommended to use the
statistical moments on which the models were trained for any variable transformations,
also to ensure that variable ranges are consistent among relative values.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>predictor_derivate</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Dummy raster</span></span></span>
<span class="r-in"><span><span class="va">r_ori</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">10</span>, ncols <span class="op">=</span> <span class="fl">10</span>, res <span class="op">=</span> <span class="fl">0.05</span>, xmin <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, xmax <span class="op">=</span> <span class="fl">1.5</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, ymax <span class="op">=</span> <span class="fl">1.5</span>, vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3600</span>,mean <span class="op">=</span> <span class="fl">.01</span>,sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize</span></span></span>
<span class="r-in"><span><span class="va">r_norm</span> <span class="op">&lt;-</span> <span class="fu">predictor_transform</span><span class="op">(</span><span class="va">r_ori</span>, option <span class="op">=</span> <span class="st">'norm'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r_ori</span>, <span class="va">r_norm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"original scale"</span>, <span class="st">"normalized units"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predictor_transform-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

