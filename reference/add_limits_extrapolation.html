<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add a control to a BiodiversityModel object to limit extrapolation — add_limits_extrapolation • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a control to a BiodiversityModel object to limit extrapolation — add_limits_extrapolation"><meta name="description" content="One of the main aims of species distribution models (SDMs) is to project
in space and time. For projections a common issue is extrapolation as - unconstrained -
SDMs can indicate areas as suitable which are unlikely to be occupied by species
or habitats (often due to historic or biotic factors). To some extent this can
be related to an insufficient quantification of the niche (e.g. niche truncation
by considering only a subset of observations within the actual distribution),
in other cases there can also be general barriers or constraints that limit
any projections (e.g. islands). This limit method adds some of those options
to a model distribution object. Currently supported methods are:
* &quot;zones&quot; - This is a wrapper to allow the addition of zones to a
distribution model object, similar to what is also possible via distribution().
Required is a spatial layer that describes a environmental zoning.
* &quot;mcp&quot; - Rather than using an external or additional layer, this option constraints
predictions by a certain distance of points in its vicinity. Buffer distances
have to be in the unit of the projection used and can be configured via
&quot;mcp_buffer&quot;.
* &quot;nt2&quot; - Constraints the predictions using the multivariate combination novelty index (NT2)
following Mesgaran et al. (2014). This method is also available in the similarity()
function.
* &quot;mess&quot; - Constraints the predictions using the
Multivariate Environmental Similarity Surfaces (MESS) following Mesgaran et al. (2014).
This method is also available in the similarity() function.
* &quot;shape&quot; - This is an implementation of the 'shape' method introduced
by Velazco et al. (2023). Through a user defined threshold it effectively limits
model extrapolation so that no projections are made beyond the extent judged as
defensible and informed by the training observations. Not yet implemented!
See also details for further explanations."><meta property="og:description" content="One of the main aims of species distribution models (SDMs) is to project
in space and time. For projections a common issue is extrapolation as - unconstrained -
SDMs can indicate areas as suitable which are unlikely to be occupied by species
or habitats (often due to historic or biotic factors). To some extent this can
be related to an insufficient quantification of the niche (e.g. niche truncation
by considering only a subset of observations within the actual distribution),
in other cases there can also be general barriers or constraints that limit
any projections (e.g. islands). This limit method adds some of those options
to a model distribution object. Currently supported methods are:
* &quot;zones&quot; - This is a wrapper to allow the addition of zones to a
distribution model object, similar to what is also possible via distribution().
Required is a spatial layer that describes a environmental zoning.
* &quot;mcp&quot; - Rather than using an external or additional layer, this option constraints
predictions by a certain distance of points in its vicinity. Buffer distances
have to be in the unit of the projection used and can be configured via
&quot;mcp_buffer&quot;.
* &quot;nt2&quot; - Constraints the predictions using the multivariate combination novelty index (NT2)
following Mesgaran et al. (2014). This method is also available in the similarity()
function.
* &quot;mess&quot; - Constraints the predictions using the
Multivariate Environmental Similarity Surfaces (MESS) following Mesgaran et al. (2014).
This method is also available in the similarity() function.
* &quot;shape&quot; - This is an implementation of the 'shape' method introduced
by Velazco et al. (2023). Through a user defined threshold it effectively limits
model extrapolation so that no projections are made beyond the extent judged as
defensible and informed by the training observations. Not yet implemented!
See also details for further explanations."><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a></li>
    <li><a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a></li>
    <li><a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a></li>
    <li><a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a></li>
    <li><a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a></li>
    <li><a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a></li>
    <li><a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add a control to a BiodiversityModel object to limit extrapolation</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/dev/R/add_limits_extrapolation.R" class="external-link"><code>R/add_limits_extrapolation.R</code></a></small>
      <div class="d-none name"><code>add_limits_extrapolation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>One of the main aims of species distribution models (SDMs) is to project
in space and time. For projections a common issue is extrapolation as - unconstrained -
SDMs can indicate areas as suitable which are unlikely to be occupied by species
or habitats (often due to historic or biotic factors). To some extent this can
be related to an insufficient quantification of the niche (e.g. niche truncation
by considering only a subset of observations within the actual distribution),
in other cases there can also be general barriers or constraints that limit
any projections (e.g. islands). This limit method adds some of those options
to a model distribution object. Currently supported methods are:</p>
<p><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">*</a> <code>"zones"</code> - This is a wrapper to allow the addition of zones to a
distribution model object, similar to what is also possible via <code><a href="distribution.html">distribution()</a></code>.
Required is a spatial layer that describes a environmental zoning.</p>
<p><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">*</a> <code>"mcp"</code> - Rather than using an external or additional layer, this option constraints
predictions by a certain distance of points in its vicinity. Buffer distances
have to be in the unit of the projection used and can be configured via
<code>"mcp_buffer"</code>.</p>
<p><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">*</a> <code>"nt2"</code> - Constraints the predictions using the multivariate combination novelty index (NT2)
following Mesgaran et al. (2014). This method is also available in the <code><a href="similarity.html">similarity()</a></code>
function.</p>
<p><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">*</a> <code>"mess"</code> - Constraints the predictions using the
Multivariate Environmental Similarity Surfaces (MESS) following Mesgaran et al. (2014).
This method is also available in the <code><a href="similarity.html">similarity()</a></code> function.</p>
<p><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">*</a> <code>"shape"</code> - This is an implementation of the 'shape' method introduced
by Velazco et al. (2023). Through a user defined threshold it effectively limits
model extrapolation so that no projections are made beyond the extent judged as
defensible and informed by the training observations. <strong>Not yet implemented!</strong></p>
<p>See also details for further explanations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_limits_extrapolation</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">layer</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mcp"</span>,</span>
<span>  mcp_buffer <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  novel <span class="op">=</span> <span class="st">"within"</span>,</span>
<span>  limits_clip <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'BiodiversityDistribution'</span></span>
<span><span class="fu">add_limits_extrapolation</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">layer</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mcp"</span>,</span>
<span>  mcp_buffer <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  novel <span class="op">=</span> <span class="st">"within"</span>,</span>
<span>  limits_clip <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="distribution.html">distribution()</a></code> (i.e. <code><a href="BiodiversityDistribution-class.html">BiodiversityDistribution</a></code>) object.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>A <code>SpatRaster</code> or <code>sf</code> object that limits the prediction
surface when intersected with input data (Default: <code>NULL</code>).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> vector describing the method used for controlling
extrapolation. Available options are <code>"zones"</code>, <code>"mcp"</code> (Default),
or <code>"nt2"</code>, <code>"mess"</code> or <code>"shape"</code>.</p></dd>


<dt id="arg-mcp-buffer">mcp_buffer<a class="anchor" aria-label="anchor" href="#arg-mcp-buffer"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> distance to buffer the mcp (Default <code>0</code>).
Only used if <code>"mcp"</code> is used.</p></dd>


<dt id="arg-novel">novel<a class="anchor" aria-label="anchor" href="#arg-novel"></a></dt>
<dd><p>Which conditions are to be masked out respectively, either the
novel conditions within only <code>"within"</code> (Default) or also including outside
reference conditions <code>"outside"</code>. Only use for <code>method = "nt2"</code>, for
<code>method = "mess"</code> this variable is always <code>"within"</code>.</p></dd>


<dt id="arg-limits-clip">limits_clip<a class="anchor" aria-label="anchor" href="#arg-limits-clip"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> Should the limits clip all predictors before
fitting a model (<code>TRUE</code>) or just the prediction (<code>FALSE</code>, default).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adds extrapolation limit option to a <code><a href="distribution.html">distribution</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For method <code>"zones"</code> a zoning layer can be supplied which is then used to intersect
the provided training points with. Any projections made with the model can
then be constrained so as to not project into areas that do not consider any
training points and are unlikely to have any. Examples for zones are for the
separation of islands and mainlands, biomes, or lithological soil conditions.</p>
<p>If no layer is available, it is also possible to constraint predictions by the
distance to a minimum convex polygon surrounding the training points with
method <code>"mcp"</code> (optionally buffered). This can make sense particular for
rare species or those fully sampled across their niche.</p>
<p>For the <code>"NT2"</code> and <code>"MESS"</code> index it is possible to constrain
the prediction to conditions within (<code>novel = "within"</code>) or also include
outside (<code>novel = "outside"</code>) conditions.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The method <code>"zones"</code> is also possible directly within <code><a href="distribution.html">distribution()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Randin, C. F., Dirnböck, T., Dullinger, S., Zimmermann, N. E., Zappa, M., &amp; Guisan, A. (2006).
Are niche‐based species distribution models transferable in space?. Journal of
biogeography, 33(10), 1689-1703. https://doi.org/10.1111/j.1365-2699.2006.01466.x</p></li>
<li><p>Chevalier, M., Broennimann, O., Cornuault, J., &amp; Guisan, A. (2021). Data integration
methods to account for spatial niche truncation effects in regional projections
of species distribution. Ecological Applications, 31(7), e02427. https://doi.org/10.1002/eap.2427</p></li>
<li><p>Velazco, S. J. E., Brooke, M. R., De Marco Jr., P., Regan, H. M., &amp;
Franklin, J. (2023). How far can I extrapolate my species distribution model?
Exploring Shape, a novel method. Ecography, 11, e06992. https://doi.org/10.1111/ecog.06992</p></li>
<li><p>Mesgaran, M. B., R. D. Cousens, B. L. Webber, and J. Franklin. (2014) Here
be dragons: a tool for quantifying novelty due to covariate range and correlation
change when projecting species distribution models. Diversity and Distributions 20:1147-1159.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="co"># To add a zone layer for extrapolation constraints.</span></span></span>
<span class="r-in"><span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">covariates</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>   <span class="fu">add_limits_extrapolation</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"zones"</span>, layer <span class="op">=</span> <span class="va">zones</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

