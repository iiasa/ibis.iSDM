<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Functionality for geographic and environmental thinning — thin_observations • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functionality for geographic and environmental thinning — thin_observations"><meta name="description" content="For most species distribution modelling approaches it is assumed
that occurrence records are unbiased, which is rarely the case. While
model-based control can alleviate some of the effects of sampling bias, it
can often be desirable to account for some sampling biases through spatial
thinning (Aiello‐Lammens et al. 2015). This is an approach based on the
assumption that over-sampled grid cells contribute little more than bias,
rather than strengthening any environmental responses. This function provides
some methods to apply spatial thinning approaches. Note that this
effectively removes data prior to any estimation and its use should be
considered with care (see also Steen et al. 2021)."><meta property="og:description" content="For most species distribution modelling approaches it is assumed
that occurrence records are unbiased, which is rarely the case. While
model-based control can alleviate some of the effects of sampling bias, it
can often be desirable to account for some sampling biases through spatial
thinning (Aiello‐Lammens et al. 2015). This is an approach based on the
assumption that over-sampled grid cells contribute little more than bias,
rather than strengthening any environmental responses. This function provides
some methods to apply spatial thinning approaches. Note that this
effectively removes data prior to any estimation and its use should be
considered with care (see also Steen et al. 2021)."><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a></li>
    <li><a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a></li>
    <li><a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a></li>
    <li><a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a></li>
    <li><a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a></li>
    <li><a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a></li>
    <li><a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Functionality for geographic and environmental thinning</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/dev/R/utils-spatial.R" class="external-link"><code>R/utils-spatial.R</code></a></small>
      <div class="d-none name"><code>thin_observations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For most species distribution modelling approaches it is assumed
that occurrence records are unbiased, which is rarely the case. While
model-based control can alleviate some of the effects of sampling bias, it
can often be desirable to account for some sampling biases through spatial
thinning (Aiello‐Lammens et al. 2015). This is an approach based on the
assumption that over-sampled grid cells contribute little more than bias,
rather than strengthening any environmental responses. This function provides
some methods to apply spatial thinning approaches. Note that this
effectively removes data prior to any estimation and its use should be
considered with care (see also Steen et al. 2021).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">thin_observations</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">background</span>,</span>
<span>  env <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  remainpoints <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mindistance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zones <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  probs <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>sf</code> object with observed occurrence points. All methods threat
presence-only and presence-absence occurrence points equally.</p></dd>


<dt id="arg-background">background<a class="anchor" aria-label="anchor" href="#arg-background"></a></dt>
<dd><p>A <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> object with the background of the study
region. Use for assessing point density.</p></dd>


<dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>A <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> object with environmental covariates. Needed when
method is set to <code>"environmental"</code> or <code>"bias"</code> (Default: <code>NULL</code>).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> of the method to be applied (Default: <code>"random"</code>).</p></dd>


<dt id="arg-remainpoints">remainpoints<a class="anchor" aria-label="anchor" href="#arg-remainpoints"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> giving the number of data points at minimum to
remain (Default: <code>10</code>).</p></dd>


<dt id="arg-mindistance">mindistance<a class="anchor" aria-label="anchor" href="#arg-mindistance"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> for the minimum distance of neighbouring observations
(Default: <code>NULL</code>).</p></dd>


<dt id="arg-zones">zones<a class="anchor" aria-label="anchor" href="#arg-zones"></a></dt>
<dd><p>A <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> to be supplied when option <code>"zones"</code> is chosen
(Default: <code>NULL</code>).</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> used as quantile threshold in <code>"bias"</code> method.
(Default: <code>0.75</code>).</p></dd>


<dt id="arg-global">global<a class="anchor" aria-label="anchor" href="#arg-global"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> if during <code>"bias"</code> method global (entire <code>env</code> raster)
or local (extracted at point locations) bias values are used as for quantile threshold.
(Default: <code>TRUE</code>).</p></dd>


<dt id="arg-centers">centers<a class="anchor" aria-label="anchor" href="#arg-centers"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> used as number of centers for <code>"environmental"</code> method.
(Default: <code>NULL</code>). If not set, automatically set to three or nlayers - 1
(whatever is bigger).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> of whether to print some statistics about the thinning
outcome (Default: <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All methods only remove points from "over-sampled" grid cells/areas. These are
defined as all cells/areas which either have more points than <code>remainpoints</code> or
more points than the global minimum point count per cell/area (whichever is larger).</p>
<p>Currently implemented thinning methods:</p><ul><li><p><code>"random"</code>: Samples at random across all over-sampled grid cells returning
only <code>"remainpoints"</code> from over-sampled cells. Does not account for any
spatial or environmental distance between observations.</p></li>
<li><p><code>"bias"</code>: This option removes explicitly points that are considered biased
only (based on <code>"env"</code>). Points are only thinned from grid cells which are
above the bias quantile (larger values equals greater bias). Thins the observations
returning <code>"remainpoints"</code> from each over-sampled and biased cell.</p></li>
<li><p><code>"zones"</code>: Thins observations from each zone that is above the over-sampled
threshold and returns  <code>"remainpoints"</code> for each zone. Careful: If the
zones are relatively wide this can remove quite a few observations.</p></li>
<li><p><code>"environmental"</code>: This approach creates an observation-wide clustering
(k-means) under the assumption that the full environmental niche has been comprehensively
sampled and is covered by the provided covariates <code>env</code>. For each over-sampled
cluster, we then obtain (<code>"remainpoints"</code>) by thinning points.</p></li>
<li><p><code>"spatial"</code>: Calculates the spatial distance between all observations.
Then points are removed iteratively until the minimum distance between points
is crossed. The <code>"mindistance"</code> parameter has to be set for this function to work.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Aiello‐Lammens, M. E., Boria, R. A., Radosavljevic, A., Vilela, B., &amp;
Anderson, R. P. (2015). spThin: an R package for spatial thinning of species
occurrence records for use in ecological niche models. Ecography, 38(5), 541-545.</p></li>
<li><p>Steen, V. A., Tingley, M. W., Paton, P. W., &amp; Elphick, C. S. (2021). Spatial
thinning and class balancing: Key choices lead to variation in the performance
of species distribution models with citizen science data. Methods in Ecology and
Evolution, 12(2), 216-226.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="co"># Thin a certain number of observations</span></span></span>
<span class="r-in"><span> <span class="co"># At random</span></span></span>
<span class="r-in"><span> <span class="va">thin_points</span> <span class="op">&lt;-</span> <span class="fu">thin_observations</span><span class="op">(</span><span class="va">points</span>, <span class="va">background</span>, method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># using a bias layer</span></span></span>
<span class="r-in"><span> <span class="va">thin_points</span> <span class="op">&lt;-</span> <span class="fu">thin_observations</span><span class="op">(</span><span class="va">points</span>, <span class="va">background</span>, method <span class="op">=</span> <span class="st">"bias"</span>, env <span class="op">=</span> <span class="va">bias</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

