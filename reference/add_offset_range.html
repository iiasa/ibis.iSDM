<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Specify a expert-based species range as offset — add_offset_range • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specify a expert-based species range as offset — add_offset_range"><meta name="description" content='This function has additional options compared to the more
generic add_offset(), allowing customized options specifically for
expert-based ranges as offsets or spatialized polygon information on species
occurrences. If even more control is needed, the user is informed of the
"bossMaps" package Merow et al. (2017). Some functionalities of that
package emulated through the "distance_function" set to "log".
This tries to fit a 5-parameter logistic function to estimate the distance
from the range (Merow et al. 2017).'><meta property="og:description" content='This function has additional options compared to the more
generic add_offset(), allowing customized options specifically for
expert-based ranges as offsets or spatialized polygon information on species
occurrences. If even more control is needed, the user is informed of the
"bossMaps" package Merow et al. (2017). Some functionalities of that
package emulated through the "distance_function" set to "log".
This tries to fit a 5-parameter logistic function to estimate the distance
from the range (Merow et al. 2017).'><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a></li>
    <li><a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a></li>
    <li><a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a></li>
    <li><a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a></li>
    <li><a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a></li>
    <li><a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a></li>
    <li><a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specify a expert-based species range as offset</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/dev/R/add_offset.R" class="external-link"><code>R/add_offset.R</code></a></small>
      <div class="d-none name"><code>add_offset_range.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function has additional options compared to the more
generic <code><a href="add_offset.html">add_offset()</a></code>, allowing customized options specifically for
expert-based ranges as offsets or spatialized polygon information on species
occurrences. If even more control is needed, the user is informed of the
<code>"bossMaps"</code> package Merow et al. (2017). Some functionalities of that
package emulated through the <code>"distance_function"</code> set to <code>"log"</code>.
This tries to fit a 5-parameter logistic function to estimate the distance
from the range (Merow et al. 2017).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_offset_range</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">layer</span>,</span>
<span>  distance_max <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  presence_prop <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  distance_clip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distance_function <span class="op">=</span> <span class="st">"negexp"</span>,</span>
<span>  field_occurrence <span class="op">=</span> <span class="st">"observed"</span>,</span>
<span>  fraction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  point <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'BiodiversityDistribution,SpatRaster'</span></span>
<span><span class="fu">add_offset_range</span><span class="op">(</span><span class="va">x</span>, <span class="va">layer</span>, fraction <span class="op">=</span> <span class="cn">NULL</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'BiodiversityDistribution,sf'</span></span>
<span><span class="fu">add_offset_range</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">layer</span>,</span>
<span>  distance_max <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  presence_prop <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  distance_clip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distance_function <span class="op">=</span> <span class="st">"negexp"</span>,</span>
<span>  field_occurrence <span class="op">=</span> <span class="st">"observed"</span>,</span>
<span>  fraction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  point <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="distribution.html">distribution()</a></code> (i.e. <code><a href="BiodiversityDistribution-class.html">BiodiversityDistribution</a></code>) object.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>A <code>sf</code> or <code>SpatRaster</code> object with the range for the target
feature.</p></dd>


<dt id="arg-distance-max">distance_max<a class="anchor" aria-label="anchor" href="#arg-distance-max"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> threshold on the maximum distance beyond
the range that should be considered to have a high likelihood of containing
species occurrences (Default: <code>Inf</code> <code>"m"</code>). Can be set to
<code>NULL</code> or <code>0</code> to indicate that no distance should be calculated.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> denoting the type of model to which this offset
is to be added. By default it assumes a <code>'poisson'</code> distributed model
and as a result the output created by this function will be
log-transformed. If however a <code>'binomial'</code> distribution is chosen,
than the output will be <code>`logit`</code> transformed. For integrated models
leave at default.</p></dd>


<dt id="arg-presence-prop">presence_prop<a class="anchor" aria-label="anchor" href="#arg-presence-prop"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> giving the proportion of all records
expected to be inside the range. By default this is set to <code>0.9</code>
indicating that 10% of all records are likely outside the range.</p></dd>


<dt id="arg-distance-clip">distance_clip<a class="anchor" aria-label="anchor" href="#arg-distance-clip"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> as to whether distance should be clipped
after the maximum distance (Default: <code>FALSE</code>).</p></dd>


<dt id="arg-distance-function">distance_function<a class="anchor" aria-label="anchor" href="#arg-distance-function"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> specifying the distance function to
be used. Available are linear (<code>"linear"</code>), negative exponential kernels (<code>"negexp"</code>,
default) and a five parameters logistic curve (<code>"logcurve"</code>) as
proposed by Merow et al. 2017.</p></dd>


<dt id="arg-field-occurrence">field_occurrence<a class="anchor" aria-label="anchor" href="#arg-field-occurrence"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> or <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> location of
biodiversity point records.</p></dd>


<dt id="arg-fraction">fraction<a class="anchor" aria-label="anchor" href="#arg-fraction"></a></dt>
<dd><p>An optional <code>SpatRaster</code> object that is multiplied with
digitized raster layer. Can be used to for example to remove or reduce the
expected value (Default: <code>NULL</code>).</p></dd>


<dt id="arg-point">point<a class="anchor" aria-label="anchor" href="#arg-point"></a></dt>
<dd><p>An optional <code>sf</code> layer with points or <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> argument. In
the case of the latter the point data is ignored (Default: <code>FALSE</code>).</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> specifying whether new offset is to be added. Setting
this parameter to <code>FALSE</code> replaces the current offsets with the new
one (Default: <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adds a range offset to a <code><a href="distribution.html">distribution</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The output created by this function creates a <code>SpatRaster</code> to be
added to a provided distribution object. Offsets in regression models are
likelihood specific as they are added directly to the overall estimate of
<code>`y^hat`</code>.</p>
<p>Note that all offsets created by this function are by default log-transformed
before export. Background values (e.g. beyond <code>"distance_max"</code>) are set
to a very small constant (<code>1e-10</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Merow, C., Wilson, A.M., Jetz, W., 2017. Integrating occurrence data and expert
maps for improved species range predictions. Glob. Ecol. Biogeogr. 26, 243–258.
https://doi.org/10.1111/geb.12539</p></li>
<li><p>Merow, C., Allen, J.M., Aiello-Lammens, M., Silander, J.A., 2016. Improving
niche and range estimates with Maxent and point process models by integrating
spatially explicit information. Glob. Ecol. Biogeogr. 25, 1022–1036.
https://doi.org/10.1111/geb.12453</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>"bossMaps"</code></p>
<p>Other offset:
<code><a href="add_offset.html">add_offset</a>()</code>,
<code><a href="add_offset_bias.html">add_offset_bias</a>()</code>,
<code><a href="add_offset_elevation.html">add_offset_elevation</a>()</code>,
<code><a href="rm_offset.html">rm_offset</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="co"># Train a presence-only model with a simple offset</span></span></span>
<span class="r-in"><span> <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">virtual_points</span>, field_occurrence <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu">add_offset_range</span><span class="op">(</span><span class="va">virtual_range</span>, distance_max <span class="op">=</span> <span class="fl">5</span>,distance_function <span class="op">=</span> <span class="st">"logcurve"</span>,</span></span>
<span class="r-in"><span> distance_clip <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="engine_glm.html">engine_glm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="train.html">train</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

