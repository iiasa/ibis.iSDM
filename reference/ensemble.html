<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Ensemble models calculated on multiple models have often been
shown to outcompete any single model in comparative assessments (Valavi et
al. 2022).
This function creates an ensemble of multiple provided distribution models
fitted with the ibis.iSDM-package. Each model has to have estimated
predictions with a given method and optional uncertainty in form of the
standard deviation or similar. Through the layer parameter it can be
specified which part of the prediction should be averaged in an ensemble.
This can be for instance the mean prediction and/or the standard deviation
sd. See Details below for an overview of the different methods.
Also returns a coefficient of variation (cv) as output of the ensemble, but
note this should not be interpreted as measure of model uncertainty as it
cannot capture parameter uncertainty of individual models; rather it reflects
variation among predictions which can be due to many factors including simply
differences in model complexity."><title>Function to create an ensemble of multiple fitted models — ensemble • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to create an ensemble of multiple fitted models — ensemble"><meta property="og:description" content="Ensemble models calculated on multiple models have often been
shown to outcompete any single model in comparative assessments (Valavi et
al. 2022).
This function creates an ensemble of multiple provided distribution models
fitted with the ibis.iSDM-package. Each model has to have estimated
predictions with a given method and optional uncertainty in form of the
standard deviation or similar. Through the layer parameter it can be
specified which part of the prediction should be averaged in an ensemble.
This can be for instance the mean prediction and/or the standard deviation
sd. See Details below for an overview of the different methods.
Also returns a coefficient of variation (cv) as output of the ensemble, but
note this should not be interpreted as measure of model uncertainty as it
cannot capture parameter uncertainty of individual models; rather it reflects
variation among predictions which can be due to many factors including simply
differences in model complexity."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a>
    <a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a>
    <a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a>
    <a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a>
    <a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a>
    <a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a>
    <a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/contributing.html">Contributing</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Function to create an ensemble of multiple fitted models</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/HEAD/R/ensemble.R" class="external-link"><code>R/ensemble.R</code></a></small>
      <div class="d-none name"><code>ensemble.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Ensemble models calculated on multiple models have often been
shown to outcompete any single model in comparative assessments (Valavi et
al. 2022).</p>
<p>This function creates an ensemble of multiple provided distribution models
fitted with the <code><a href="ibis.iSDM-package.html">ibis.iSDM-package</a></code>. Each model has to have estimated
predictions with a given method and optional uncertainty in form of the
standard deviation or similar. Through the <code>layer</code> parameter it can be
specified which part of the prediction should be averaged in an ensemble.
This can be for instance the <em>mean</em> prediction and/or the standard deviation
<em>sd</em>. See Details below for an overview of the different methods.</p>
<p>Also returns a coefficient of variation (cv) as output of the ensemble, but
note this should not be interpreted as measure of model uncertainty as it
cannot capture parameter uncertainty of individual models; rather it reflects
variation among predictions which can be due to many factors including simply
differences in model complexity.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for ANY,character,numeric,numeric,character,logical,character</span></span>
<span><span class="fu">ensemble</span><span class="op">(</span><span class="va">...</span>,<span class="va">method</span>,<span class="va">weights</span>,<span class="va">min.value</span>,<span class="va">layer</span>,<span class="va">normalize</span>,<span class="va">uncertainty</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>...</dt>
<dd><p>Provided <code><a href="DistributionModel-class.html">DistributionModel</a></code> objects.</p></dd>


<dt>method</dt>
<dd><p>Approach on how the ensemble is to be created. See details for
available options (Default: <code>'mean'</code>).</p></dd>


<dt>weights</dt>
<dd><p>(<em>Optional</em>) weights provided to the ensemble function if
weighted means are to be constructed (Default: <code>NULL</code>).</p></dd>


<dt>min.value</dt>
<dd><p>A optional <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> stating a minimum value that needs
to be surpassed in each layer before calculating and ensemble
(Default: <code>NULL</code>).</p></dd>


<dt>layer</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> of the layer to be taken from each prediction
(Default: <code>'mean'</code>). If set to <code>NULL</code> ignore any of the layer
names in ensembles of <code>SpatRaster</code> objects.</p></dd>


<dt>normalize</dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> on whether the inputs of the ensemble should be
normalized to a scale of 0-1 (Default: <code>FALSE</code>).</p></dd>


<dt>uncertainty</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> indicating how the uncertainty among
models should be calculated. Available options include <code>"none"</code>, the
standard deviation (<code>"sd"</code>), the average of all PCA axes except the
first <code>"pca"</code>, the coefficient of variation (<code>"cv"</code>, Default) or
the range between the lowest and highest value (<code>"range"</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code><a href="https://rdrr.io/pkg/terra/man/SpatRaster-class.html" class="external-link">SpatRaster</a></code> object containing the ensemble of the provided
predictions specified by <code>method</code> and a coefficient of variation
across all models.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Possible options for creating an ensemble includes:</p><ul><li><p><code>'mean'</code> - Calculates the mean of several predictions.</p></li>
<li><p><code>'median'</code> - Calculates the median of several predictions.</p></li>
<li><p><code>'max'</code> - The maximum value across predictions.</p></li>
<li><p><code>'min'</code> - The minimum value across predictions.</p></li>
<li><p><code>'weighted.mean'</code> - Calculates a weighted mean. Weights have to be supplied separately (e.g. TSS).</p></li>
<li><p><code>'min.sd'</code> - Ensemble created by minimizing the uncertainty among predictions.</p></li>
<li><p><code>'threshold.frequency'</code> - Returns an ensemble based on threshold frequency (simple count). Requires thresholds to be computed.</p></li>
<li><p><code>'pca'</code> - Calculates a PCA between predictions of each algorithm and then extract the first axis (the one explaining the most variation).</p></li>
</ul><p>In addition to the different ensemble methods, a minimal threshold
(<code>min.value</code>) can be set that needs to be surpassed for averaging. By
default this option is not used (Default: <code>NULL</code>).</p>
<p>Note by default only the band in the <code>layer</code> parameter is composited. If
supported by the model other summary statistics from the posterior (e.g.
<code>'sd'</code>) can be specified.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If a list is supplied, then it is assumed that each entry in the list
is a fitted <code><a href="DistributionModel-class.html">DistributionModel</a></code> object. Take care not to create an ensemble
of models constructed with different link functions, e.g. logistic vs <a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">log</a>.
In this case the <code>"normalize"</code> parameter has to be set.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Valavi, R., Guillera‐Arroita, G., Lahoz‐Monfort, J. J., &amp; Elith, J. (2022). Predictive performance of presence‐only species distribution models: a benchmark study with reproducible code. Ecological Monographs, 92(1), e01486.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="co"># Assumes previously computed predictions</span></span></span>
<span class="r-in"><span> <span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">ensemble</span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span>, <span class="va">mod3</span>, method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Make a bivariate plot (might require other packages)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="bivplot.html">bivplot</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

