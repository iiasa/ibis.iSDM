<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add latent spatial effect to the model equation — add_latent_spatial • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add latent spatial effect to the model equation — add_latent_spatial"><meta name="description" content="In general we understand under latent spatial effects the
occurrence of spatial dependency in the observations, which might either be
caused by spatial biases, similarities in the underlying sampling processes
or unmeasured latent covariates, e.g. those that have not been quantified.
This package supports a range of different spatial effects, however they
differ from another by their impact on the estimated prediction. Some effects
simply add the spatial dependence as covariate, others make use of spatial
random effects to account for spatial dependence in the predictions. By
default these effects are added to each dataset as covariate or shared
spatial field (e.g. SPDE). See details for an explanation of the available
options."><meta property="og:description" content="In general we understand under latent spatial effects the
occurrence of spatial dependency in the observations, which might either be
caused by spatial biases, similarities in the underlying sampling processes
or unmeasured latent covariates, e.g. those that have not been quantified.
This package supports a range of different spatial effects, however they
differ from another by their impact on the estimated prediction. Some effects
simply add the spatial dependence as covariate, others make use of spatial
random effects to account for spatial dependence in the predictions. By
default these effects are added to each dataset as covariate or shared
spatial field (e.g. SPDE). See details for an explanation of the available
options."><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a></li>
    <li><a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a></li>
    <li><a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a></li>
    <li><a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a></li>
    <li><a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a></li>
    <li><a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a></li>
    <li><a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add latent spatial effect to the model equation</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/v0.1.4/R/add_latent.R" class="external-link"><code>R/add_latent.R</code></a></small>
      <div class="d-none name"><code>add_latent_spatial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In general we understand under latent spatial effects the
occurrence of spatial dependency in the observations, which might either be
caused by spatial biases, similarities in the underlying sampling processes
or unmeasured latent covariates, e.g. those that have not been quantified.</p>
<p>This package supports a range of different spatial effects, however they
differ from another by their impact on the estimated prediction. Some effects
simply add the spatial dependence as covariate, others make use of spatial
random effects to account for spatial dependence in the predictions. By
default these effects are added to each dataset as covariate or shared
spatial field (e.g. SPDE). See details for an explanation of the available
options.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_latent_spatial</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"spde"</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separate_spde <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'BiodiversityDistribution'</span></span>
<span><span class="fu">add_latent_spatial</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"spde"</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separate_spde <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'BiodiversityScenario'</span></span>
<span><span class="fu">add_latent_spatial</span><span class="op">(</span><span class="va">x</span>, layer <span class="op">=</span> <span class="cn">NULL</span>, reuse_latent <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="distribution.html">distribution()</a></code> (i.e. <code><a href="BiodiversityDistribution-class.html">BiodiversityDistribution</a></code>) object.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> describing what kind of spatial effect is to be
added to the model. See details.</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>A <code>"Prior-List"</code> object supplied to the latent effect.
Relevant only for <code><a href="engine_inla.html">engine_inla</a></code> and <code>NULL</code> equates the use of default priors.</p></dd>


<dt id="arg-separate-spde">separate_spde<a class="anchor" aria-label="anchor" href="#arg-separate-spde"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> parameter indicating whether, in the case
of SPDE effects, separate effects for each likelihood are being fitted.
Default (<code>FALSE</code>) uses a copy of the first added likelihood.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed down</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>A <code>SpatRaster</code> layer describing alternative latent effects to be used instead
if <code>"reuse_latent"</code> is set to <code>FALSE</code>.</p></dd>


<dt id="arg-reuse-latent">reuse_latent<a class="anchor" aria-label="anchor" href="#arg-reuse-latent"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> flag on whether any latent effects found
in the fitted model should be reused (Default <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adds latent spatial effect to a <code><a href="distribution.html">distribution</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are several different options some of which depend on the
engine used. In case a unsupported method for an engine is chosen this is
modified to the next similar method.</p>
<p><strong>Available are:</strong></p><ul><li><p><code>"spde"</code> - stochastic partial differential equation (SPDE) for
<code><a href="engine_inla.html">engine_inla</a></code> and <code><a href="engine_inlabru.html">engine_inlabru</a></code>. SPDE effects aim at capturing the
variation of the response variable in space, once all of the covariates are
accounted for. Examining the spatial distribution of the spatial error can
reveal which covariates might be missing. For example, if elevation is
positively correlated with the response variable, but is not included in
the model, we could see a higher posterior mean in areas with higher
elevation. Note that calculations of SPDE's can be computationally costly.</p></li>
<li><p><code>"car"</code> - conditional autocorrelative errors (CAR) for <code><a href="engine_inla.html">engine_inla</a></code>.
Not yet implemented in full.</p></li>
<li><p><code>"kde"</code> - additional covariate of the kernel density of input point observations.</p></li>
<li><p><code>"poly"</code> - spatial trend correction by adding coordinates as polynominal
transformation. This method assumed that a transformation of spatial coordinates
can if - included as additional predictor - explain some of the variance in the
distribution. This method does not interact with species occurrences.</p></li>
<li><p><code>"nnd"</code> - nearest neighbour distance. This function calculates the euclidean
distance from each point to the nearest other grid cell with known species occurrence.
Originally proposed by Allouche et al. (2008) and can be applied across all
datasets in the <code><a href="BiodiversityDistribution-class.html">BiodiversityDistribution</a></code>) object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Allouche, O.; Steinitz, O.; Rotem, D.; Rosenfeld, A.; Kadmon, R. (2008). Incorporating
distance constraints into species distribution models. Journal of Applied
Ecology, 45(2), 599-609. doi:10.1111/j.1365-2664.2007.01445.x</p></li>
<li><p>Mendes, P., Velazco, S. J. E., de Andrade, A. F. A., &amp; Júnior, P. D. M. (2020).
Dealing with overprediction in species distribution models: How adding distance
constraints can improve model accuracy. Ecological Modelling, 431, 109180.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">add_latent_spatial</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

