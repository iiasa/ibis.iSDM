<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ibis.iSDM">
<title>Frequently Asked Questions (FAQ) • ibis.iSDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Frequently Asked Questions (FAQ)">
<meta property="og:description" content="ibis.iSDM">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Martin_Ecology">
<meta name="twitter:site" content="@IIASAVienna">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_data_preparationhelpers.html">1. Helper functions to prepare inputs</a>
    <a class="dropdown-item" href="../articles/02_train_simple_model.html">2. Train a model</a>
    <a class="dropdown-item" href="../articles/03_integrate_data.html">3. Integrate data</a>
    <a class="dropdown-item" href="../articles/04_biodiversity_projections.html">4. Biodiversity projections</a>
    <a class="dropdown-item" href="../articles/05_mechanistic_estimation.html">5. Simulating mechanisms</a>
    <a class="dropdown-item" href="../articles/06_engine_comparison.html">6. Engine comparison</a>
    <a class="dropdown-item" href="../articles/07_package_comparison.html">7. Other packages</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/08_frequently-asked-questions.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/contributing.html">Contributing</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Frequently Asked Questions (FAQ)</h1>
                        <h4 data-toc-skip class="author">Martin
Jung</h4>
            
            <h4 data-toc-skip class="date">2023-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/HEAD/vignettes/articles/08_frequently-asked-questions.Rmd" class="external-link"><code>vignettes/articles/08_frequently-asked-questions.Rmd</code></a></small>
      <div class="d-none name"><code>08_frequently-asked-questions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="frequently-asked-questions-faq">Frequently Asked Questions (FAQ)<a class="anchor" aria-label="anchor" href="#frequently-asked-questions-faq"></a>
</h2>
<p>This document contains a series of frequently asked questions when
using the <code>ibis.iSDM</code> package and is a work in progress.</p>
<div class="section level3">
<h3 id="data-and-model-preparation">Data and model preparation<a class="anchor" aria-label="anchor" href="#data-and-model-preparation"></a>
</h3>
<details><summary><b>What are the necessary data preparation steps for
<code>ibis.iSDM</code> ?</b>
</summary><p>The <code>ibis.iSDM</code> R-package can handle most standard spatial
formats in R (such as vector or raster formats) and works predominantly
with the [<code>sf</code>], [<code>SpatRaster</code>] and
[<code>stars</code>] packages to do much of the formatting and
processing work. When adding [<code>biodiversity</code>] and
[<code>predictor</code>] variables to a <code><a href="../reference/distribution.html">distribution()</a></code>
object a number of default validity checks and alignments are commonly
conducted, for instance ensuring that provided points align in
geographic projection.</p>
<p>To ease up the modelling and to avoid any unfortunate errors or
crashes, ideally ensure the following steps are taken:</p>
<ul>
<li>A <code>'background'</code> layer describing the modelling extent is
provided directly as [<code>sf</code>] <code>'POLYGON'</code> or
<code>'MULTIPOLYGON'</code> object and covers all biodiversity and
predictor data.</li>
<li>All provided data are in the same geographic projection.</li>
<li>Biodiversity data is provided in [<code>sf</code>] format and covers
the <code>'background'</code> bounding box. Furthermore each
biodiversity dataset has a set <code>"field_occurrence"</code> field
with numeric values.</li>
<li> is appropriately formatted (see also below).</li>
</ul>
<p><strong>Important:</strong> For environmental predictors it becomes
important to ensure that nodata values are appropriately handled.
Unfortunately many of the implemented [<code>engines</code>] can not
handle nodata values well, thus it is necessary during the
pre-processing to remove any rows of covariate extraction where at least
one variable has missing data. For instance by assinging a constant to
<code>NA</code> values:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
</details><details><summary><b>I have presence-only data (GBIF and co). How can I model the
probability of occurrence? </b>
</summary><p>Technically, it is impossible to estimate a probability of occurrence
just with presence-only data (such as commonly available from databases
like GBIF). What people normally do is to add so called pseudo-absence
(often in excessive numbers) over the entire background to their data,
approximating the probability of occurrence by assuming that detection
probability is uniform over the landscape (see <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1600-0587.2013.07872.x" class="external-link">Merow
et al. 2013</a>).</p>
<p>The <code>ibis.iSDM</code> package follows the design principle that
all data types (e.g. presence-only or presence-absence records) should
be modelled with the least amount of assumptions possible. For
presence-only records the default way of estimating any kind of
responses or habitat suitability is to estimate such data following a
Poisson-Process modelling approach. However, it is possible to add these
pseudo-absence points to a presence-only dataset as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_points</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/input_data.gpkg'</span>, package<span class="op">=</span><span class="st">'ibis.iSDM'</span><span class="op">)</span>, <span class="st">'points'</span>,quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># This takes the default pseudo-absence options created when loading the Ibis package.</span></span>
<span><span class="va">virtual_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_pseudoabsence.html">add_pseudoabsence</a></span><span class="op">(</span><span class="va">virtual_points</span>, field_occurrence <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span></span>
<span><span class="co"># Check that absence points are present</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">virtual_points</span><span class="op">$</span><span class="va">Observed</span><span class="op">)</span></span></code></pre></div>
<p>Also see the <code><a href="../reference/add_pseudoabsence.html">add_pseudoabsence()</a></code> and
<code><a href="../reference/pseudoabs_settings.html">pseudoabs_settings()</a></code> help pages for more settings and also
the first article on this website. For example it is possible to define
pseudo-absence sampling in specific spatial formats, such as sampling
within or outside a minimum convex polygon (MCP) of all presence points
or within a certain buffer.</p>
</details><details><summary><b> The package seem to have many suggested dependencies. Is there a way
to install them all?</b>
</summary><p>Yes, the ibis.iSDM package uses a range of different functionalities
from other, existing packages and if these functions are required for a
specific purpose, the packages in question should be installed.</p>
<p>An easy convenience functions to install all packages is
<code><a href="../reference/ibis_dependencies.html">ibis_dependencies()</a></code> which installs all the packages listed
in <code>getOption("ibis.dependencies")</code>.</p>
</details>
</div>
<div class="section level3">
<h3 id="model-setup">Model setup<a class="anchor" aria-label="anchor" href="#model-setup"></a>
</h3>
<details><summary><b>Is it possible to transform input predictors before model
fitting?</b>
</summary>
Yes, in many instances it is desirable to transform input predictors to
a new range or to remove extreme values from the predictors. For example
the popular [<code>maxnet</code>] R-package for Maximum entropy
estimation of species distribution modelling often transforms the
variables via quadratic, hinge or threshold transformations. Although
this can also (and preferably should) be done before setting up a model,
there are options available to transform the predictors when they are
added to the model. See the help page of [<code><a href="../reference/add_predictors.html">add_predictors()</a></code>]
for examples and descriptions.
</details><details><summary><b>Is there a way to limit my predictions to only certain regions in the
extent?</b>
</summary><p>Yes, this can be a desirable outcome during the modelling. For
instance one can make - in the absence of better information on
dispersal constrain (see [<code>add_constrain_dispersal</code>]) - the
assumption that certain species can only disperse within a given
ecoregion and not beyond. See for instance the method section of <a href="https://link.springer.com/article/10.1007/s10113-021-01755-5#Sec2" class="external-link">Wessels,
Merow and Trisos (2021)</a>.</p>
<p>To do this directly with the <code>ibis.iSDM</code> R-package, one
has to specify the limit of projection to the
[<code><a href="../reference/distribution.html">distribution()</a></code>] object. In this context the zones extent
over the whole background (and have the same extent and spatial scale).
The prediction will however be limited only to those zones where
supplied biodiversity observations fall in.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Where zone is a provided raster</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span>, limits <span class="op">=</span> <span class="va">zone</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/engine_gdb.html">engine_gdb</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternatively one can also create such limits based on a minimum convex polygon</span></span>
<span><span class="co"># of the provided data. Here we create a non-buffered MCP across all points used</span></span>
<span><span class="co"># in species_data to constrain the prediction.</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span>, limits_method <span class="op">=</span> <span class="st">"mcp"</span>, mcp_buffer <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/engine_gdb.html">engine_gdb</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p>There is further a dedicated function
([<code>create_zonaloccurrence_mask()</code>]) to help set up such
zones, either by taking existing categorical raster datasets or by
constructing buffers around existing presence records (which could for
example reflect assumed maximum dispersal distances).</p>
</details><details><summary><b>How exactly do I add a prior to a model ?</b>
</summary><p>The <code>ibis.iSDM</code> R-package allows to users to add prior
information on parameters to any model to be estimated. These priors
have to be added as engine-specific priors and their format depends on
the engine in question (see specific help pages for more information). A
prior can generally be define via a combination of
<code>ENGINENAME</code> + <code>Prior</code> and has to be wrapped in a
<code>PriorList</code> to be used in the estimation.</p>
<p>Example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We have prior information that 'Forest' is important for a species</span></span>
<span><span class="co"># In this case and for the INLA engine we define normal prior on the mean and precision</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/INLAPrior.html">INLAPrior</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"Forest"</span>,type <span class="op">=</span> <span class="st">"normal"</span>,hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># This is then wrapped in a PriorList</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/priors.html">priors</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span> <span class="va">pp</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># We can specify multiple priors of course</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/INLAPrior.html">INLAPrior</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"Forest"</span>,type <span class="op">=</span> <span class="st">"normal"</span>,hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/INLAPrior.html">INLAPrior</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"Cropland"</span>,type <span class="op">=</span> <span class="st">"normal"</span>,hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/priors.html">priors</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And can now added to the model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span>, limits <span class="op">=</span> <span class="va">zone</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">covariates</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_priors.html">add_priors</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">pp</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/engine_inlabru.html">engine_inlabru</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Multiple priors for an Engine can be defined in a
<code>PriorList</code>. Whenever a prior for the same variable is set
again, it overwrites the previous value.</p>
</details><details><summary><b>How can I control pseudo-absence sampling, for instance with targeted
sampling? </b>
</summary><p>A great number of SDM literature suggests that altering how the
background / pseudo-absence points are created, can greatly affect model
outcomes (see <code><a href="../reference/add_pseudoabsence.html">add_pseudoabsence()</a></code> for references). In the
<code>ibis.iSDM</code> R-package there are options available to modify
how pseudo-absence points are created. By default the package creates at
least 10 000 points or at least 25% of the presence-points (what ever is
larger). To change the default pseudo-absence sampling settings, there
are two options. Either change the global default settings for
pseudo-absence sampling or by adding these settings to the
<code>add_biodiversity</code> function.</p>
<p>To overwrite the global settings, do the following:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define new settings with greater number of background points</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pseudoabs_settings.html">pseudoabs_settings</a></span><span class="op">(</span>background <span class="op">=</span> <span class="cn">NULL</span>, nrpoints <span class="op">=</span>  <span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="co"># Overwrite the default settings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ibis.pseudoabsence"</span> <span class="op">=</span> <span class="va">ss</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively one could think of specifying specific pseudo-absence
sampling information to one biodiversity dataset specifically:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define absence layer with biased background to sample from</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pseudoabs_settings.html">pseudoabs_settings</a></span><span class="op">(</span>background <span class="op">=</span> <span class="cn">NULL</span>, bias <span class="op">=</span> <span class="va">bias_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assuming background and point data exists</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">points</span>, pseudoabsence_settings <span class="op">=</span> <span class="va">ss</span><span class="op">)</span></span></code></pre></div>
</details><details><summary><b>What are the options for parallelization in
<code>ibis.iSDM</code>?</b>
</summary><p>Most code in the <code>ibis.iSDM</code> R-package is by default
already parallelized and many computationally-intensive operations
should be making use of all cores (if you can find an example where this
is not the case, please raise an issue). The number of cores is
generally being decided by the option <code>"ibis.nthread"</code> in
[<code><a href="../reference/ibis_options.html">ibis_options()</a></code>].</p>
<p>In most cases, parallelized code will be run via the
[<code>parallel</code>] and [<code>doParallel</code>] packages, although
there is some code in its infancy to support the [<code>future</code>]
parallelization approaches as well, offering greater flexibility. See
the function [<code>ibis_future</code>] for more information also on the
use.</p>
<p>The typical use case is thus to run separate models (via
<code><a href="../reference/train.html">train()</a></code>) in a loop or scheduler of a
High-Performance-Computer. Users should be careful in the case of shared
resources, e.g. don’t parallelize such operations on the same machine.
If there is a need to parallelize multiple models on the same instance,
it is suggested to disable the <code>'ibis.runparallel'</code>
option.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check ibis options if set</span></span>
<span><span class="fu"><a href="../reference/ibis_options.html">ibis_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">'ibis.runparallel'</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Set to FALSE</span></span></code></pre></div>
</details><details><summary><b> Can I add multiple offsets to a <code>distribution()</code> object
?</b>
</summary><p>Yes. The <code><a href="../reference/add_offset.html">add_offset()</a></code> and
<code><a href="../reference/add_offset_range.html">add_offset_range()</a></code> functions allows to specify a spatial
explicit offset term which is then added to the regression model in
question. An offset is generally just a coefficient set to a specific
value. To get more than one offset, one just needs to combine the
different provided offsets in a way that is consistent to get that fixed
value (see <a href="https://stats.stackexchange.com/questions/250528/is-it-possible-to-use-two-offsets" class="external-link">here</a>
for reference. This can be done either by summing them as transformed
value (discouraged as it can be errorprone) or by simply multiplying
them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">offset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">offset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">offset1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">offset2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">offset1</span><span class="op">*</span><span class="va">offset2</span><span class="op">)</span></span></code></pre></div>
<p>Internally all provided offsets to model object are combined via
simple addition together. This thus requires that users transform them
aprior (for instance log transform) before adding them to the
estimation.</p>
</details>
</div>
<div class="section level3">
<h3 id="fitting-and-scenarios">Fitting and Scenarios<a class="anchor" aria-label="anchor" href="#fitting-and-scenarios"></a>
</h3>
<details><summary><b>There are too many messages. How can I run <code>ibis.iSDM</code>
more verbosely ?</b>
</summary><p>There are two options that can be enabled to reduce the number of
messages:</p>
<ul>
<li>By setting the parameter <code>verbose</code> in
<code><a href="../reference/train.html">train()</a></code> to <code>FALSE</code> all messages created by the
respective engine are suppressed.</li>
<li>Setting the parameter <code>ibis.setupmessages</code> to
<code>FALSE</code> suppresses all other package related message. This
can be done via</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ibis.setupmessages"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</details><details><summary><b> How can I make use of cross-validation in <code>ibis.iSDM</code>
?</b>
</summary><p>Cross-validation has been deliberatly not integrated into package.
Users who would like to make use of cross-validation techniques thus
need to set up their own external modelling routines. Reason is that
with the multiple types of integration in this package, the construction
of (independent) testing datasets is not as trivial (considering for
example offsets, priors or multiple datasets).</p>
</details><details><summary><b>Why are there 2 INLA engines and which one should I use ? </b>
</summary><p>In the <code>ibis.iSDM</code> R-package there are two engines that
makes use of the INLA framework, namely [<code>engine_inla</code>] and
[<code>engine_inlabru</code>]. When the package author started
developing this package, the [<code>engine_inlabru</code>] did not yet
support multiple likelihoods and thus this was implemented directly.
Predictions from [<code>engine_inla</code>] and
[<code>engine_inlabru</code>] should be identical, although the latter
does not infer the predictions directly, instead simulating from the
posterior. This simulation is particularly helpful for creating (future)
projections as otherwise a new model would need to be fitted for every
newdata object.</p>
Users are advised to use [<code>engine_inlabru</code>] by
<strong>default</strong> in most cases and only use
[<code>engine_inla</code>] if predictions look uncertain.
</details><details><summary><b> I am concerned about extrapolation during prediction. What options
do I have? </b>
</summary><p>When creating predictive models such as SDMs it is often a concern to
not predict to a variable range outside the environmental conditions for
which a model was trained. The <code>ibis.iSDM</code> package supports
variable ‘clamping’ of its predictions similar as the popular Maxent
model, however for each [<code>engine</code>]. Clamping can be enabled
by setting the parameter <code>clamp</code> in [<code>train</code>] to
<code>TRUE</code>. This restricts any spatial (or spatial-temporal)
projections to the combined <code>range</code> of predictor variables
observed for each of the training localities.</p>
<p>Similar functionalities are also available separately during scenario
projections by setting adaptability constraints (see
[<code>add_constraint_adaptability</code>] or
[<code>add_constraint_boundary</code>]).</p>
</details><details><summary><b>I am using (too) many predictors in my model. What options do I have
?</b>
</summary><p>Having too many predictors in a SDM can be a cause of substantial
over-parametrization and subsequently overfitting (e.g. the model is
reproducing the data it was trained with rather than projecting into
areas unknown).</p>
<p>It is recommended to (a) either use an engine with very strong
regularization, such as for example [<code>engine_glmnet</code>] or
[<code>engine_gdb</code>], (b) train a model with caution and have a
minimum number of observations (arbitrary rule of thumb, have at least
10 observations for each additional predictor included), (c) make use of
pre-estimation removal of predictor, such for example through variable
importance criteria or colinearity. See code below for an example.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prior to model fitting, remove highly collinear predictors through a pearson correlation assessment</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/engine_glmnet.html">engine_glmnet</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>filter_predictors <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternatively use a RandomForest estimator to remove the least important variables</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/engine_glmnet.html">engine_glmnet</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>filter_predictors <span class="op">=</span> <span class="st">"RF"</span><span class="op">)</span></span></code></pre></div>
</details><details><summary><b>Where can I find predictions created by <code>train</code> ? </b>
</summary><p>After a <code>distribution</code> model has been trained and if the
<code>inference_only</code> parameter in <code><a href="../reference/train.html">train()</a></code> has been
set to <code>FALSE</code> (Default), the outputs of the prediction be
found in the created object as a <code>SpatRaster</code>. By default all
engines will produce a <code>SpatRaster</code> object with at least one
band called “mean” which is the average prediction by the engine. This
is also the result returned when the created model object is
plotted.</p>
<p>In addition, for Bayesian Engines other bands quantifying the
posterior predictive uncertainty might be available and can be plotted
as well. The raster can also be saved a spatial GeoTiff to a given
filename using the <code><a href="../reference/write_output.html">write_output()</a></code> function.</p>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">species_data</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/engine_inlabru.html">engine_inlabru</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># To plot </span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"sd"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To get the layer</span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To save the output layer as floating point geoTiff</span></span>
<span><span class="fu"><a href="../reference/write_output.html">write_output</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"myoutput.tif"</span>, type <span class="op">=</span> <span class="st">"gtif"</span>, dt <span class="op">=</span> <span class="st">"FLT4S"</span><span class="op">)</span></span></code></pre></div>
</details><details><summary><b>Predictions from <code>engine_xgboost</code> look pixelated?</b>
</summary><p>This is usually due to either the number of rounds for estimation
being too low or the learning_rate being to high. Try out different
options in the parameters of the engine. A good way to check the
performance is also to plot the evaluation log and
<strong>logloss</strong>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Requires a fitted model</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"fit_best"</span><span class="op">)</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="model-troubleshooting">Model troubleshooting<a class="anchor" aria-label="anchor" href="#model-troubleshooting"></a>
</h3>
<details><summary><b>How exactly does the model integration work and how does it differ
among engines?</b>
</summary><p>There are various forms of integration from a simple approach of
adding [<code>ensembles</code>], [<code>priors</code>] or
[<code>offsets</code>] to fully integrated multiple likelihood models
(see <a href="https://doi.org/10.1002/ecy.2710" class="external-link">Fletcher et
al. 2019</a>). Thus, users have a range of possibilities to combine
different sources of evidence in their modelling.</p>
<p>With regards to how different [<code>engines</code>] treat multiple
biodiversity datasets. Unfortunately only the
[<code><a href="../reference/engine_inla.html">engine_inla()</a></code>], [<code><a href="../reference/engine_inlabru.html">engine_inlabru()</a></code>] and
[<code><a href="../reference/engine_stan.html">engine_stan()</a></code>] support fully integrated multiple
likelihood models. A full overview can be found in the <a href="04_engine_comparison.html">Engine comparison</a> table. All other
[<code>engines</code>] combine multiple datasets by running separate
models in sequence where the order is determined by the sequence the
datasets were added to the model. Within the <code><a href="../reference/train.html">train()</a></code>
function, users have the option of specifying how previous predictions
should be handled through the [<code>method_integration</code>]
parameter. For example predictions from one model could be added as
predictors or offset to the next. Or the coefficients from one model can
be used to create starting priors for the next model.</p>
</details><details><summary><b>What can I do when my model outputs with presence-only data seem
odd?</b>
</summary><p>By default, presence only biodiversity data is modelled as
point-process model (PPM, see <a href="http://doi.wiley.com/10.1111/2041-210X.12352" class="external-link">Renner et
al. 2015</a>). Similar as Maximum Entropy models these models can be
quite sensitive to biased input, which is common for most non-structured
biodiversity observations where presence points tend to be clustered in
urban or easily accessible areas. To avoid predictions being biased
towards those covariates, there are a number of things that can
potentially be done here.</p>
<ul>
<li>Modify the targeted background sampling for better control of
background points. This can be for instance done via the
<code><a href="../reference/add_pseudoabsence.html">add_pseudoabsence()</a></code> and <code><a href="../reference/pseudoabs_settings.html">pseudoabs_settings()</a></code>
methods. See the respective help files.</li>
<li>Make use of spatial thinning approaches. See for instance <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ecog.01132" class="external-link">Aiello-Lammers
et al. 2015</a> and <a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/2041-210X.13525" class="external-link">Steen
et al. 2021</a>. Note however that spatial thinning does remove data
points, affecting for instance any <code>poisson</code> distributed
models (PPMs) in the process. The<code>ibis.iSDM</code> package has some
functionality for spatial thinning implemented in the
<code><a href="../reference/thin_observations.html">thin_observations()</a></code> function.</li>
<li>Partial out a biased variable during the prediction. The
<code><a href="../reference/add_control_bias.html">add_control_bias()</a></code> function can be used to specify a value
that needs to be partialed out in the model. There a
<code>bias_value</code> has to be specified and this can be set for
instance to <code>0</code> or an amount assumed to be equivalent to
minimal bias.</li>
<li>Consider setting the [<code>clamp</code>] parameter in
<code><a href="../reference/train.html">train()</a></code> to <code>TRUE</code>.</li>
<li>Add a spatial offset to account for the bias as introduced in <a href="http://doi.wiley.com/10.1111/geb.12453" class="external-link">Merow et al. 2016</a>.
This can be done via the <code><a href="../reference/add_offset_bias.html">add_offset_bias()</a></code> function and
requires preparation of a bias layer in advance.</li>
<li>Apply more rigorous filtering and bias control to the input data. In
the end no correction can replace good data preparation and cleaning.
Remember the <a href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out" class="external-link">GIGO
principle</a>.</li>
</ul></details><details><summary><b>My model keeps crashing, what can I do?</b>
</summary>
Sorry to hear and unless the model or input data are grossely
misspecified, this should not happen. Consider changing the input
covariates. Often scaling the covariates (see
<code><a href="../reference/add_predictors.html">add_predictors()</a></code>) can help with model convergence.
Similarly if the use of discrete variables (e.g. `<code>factor</code>
predictors) results in errors, consider setting the parameter
“explode_factors” to TRUE in <code><a href="../reference/add_predictors.html">add_predictors()</a></code>. This will
create additional covariates for every factor level. Please report an <a href="https://github.com/iiasa/ibis.iSDM/issues" class="external-link">issue</a> with the
concrete error message, your R session information (call
<code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code>) and preferably some example data and code.
</details>
</div>
<div class="section level3">
<h3 id="any-other-questions-and-issues">Any other questions and issues<a class="anchor" aria-label="anchor" href="#any-other-questions-and-issues"></a>
</h3>
<details><summary><b>Can I transform the prediction output to a suitability index?</b>
</summary><p>Often it is easier to communicate an index of suitability (scale
[0-1]) to stakeholders and policy, which can in principle be derived
from <em>ibis.iSDM</em> output. Especially when using Poisson Process
models to infer the suitability of a given area, the units can be hard
to interpret for non-scientists. An easy way to achieve this has been
added as a function to each Biodiversity distribution object. See below
for an example.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train a model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribution.html">distribution</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Presence-absence data</span></span>
<span>  <span class="fu"><a href="../reference/add_biodiversity_poipo.html">add_biodiversity_poipo</a></span><span class="op">(</span><span class="va">my_gbifpoints</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/engine_glmnet.html">engine_glmnet</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a transformed prediction of the suitability layer</span></span>
<span><span class="co"># The output is a normalized prediction surface </span></span>
<span><span class="co"># created via (x - min) / (max - min) or x/sum(x) respectively</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="fu">calc_suitabilityindex</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><details><summary><b>The names of my variables are slightly changing when added to a
model?</b>
</summary><p>This is a feature, not a bug ;) Many covariates often come with
unusual characters and symbols that can not be readily used in equations
or in queries of tabular data. The <code><a href="../reference/sanitize_names.html">sanitize_names()</a></code>
function cleans those variable names and removes / resets non conform
symbols.</p>
<pre><code><span><span class="co"># It can be disabled by setting the following option to false at the start of the script.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">'ibis.cleannames'</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</details>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
