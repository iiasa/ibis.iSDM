<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="For most species distribution modelling approaches it is assumed that occurrence records are unbiased, which
is rarely the case. While model-based control can alleviate some of the effects of sampling bias, it can often be
desirable to account for some sampling biases through spatial thinning (Aiello‐Lammens et al. 2015). This
is an approach based on the assumption that oversampled grid cells contribute little more than bias, rather than
strengthing any environmental responses.
This function provides some methods to apply spatial thinning approaches. Note that this effectively removes
data prior to any estimation and its use should be considered with care (see also Steen et al. 2021)."><title>Functionality for geographic and environmental thinning — thin_observations • ibis.iSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functionality for geographic and environmental thinning — thin_observations"><meta property="og:description" content="For most species distribution modelling approaches it is assumed that occurrence records are unbiased, which
is rarely the case. While model-based control can alleviate some of the effects of sampling bias, it can often be
desirable to account for some sampling biases through spatial thinning (Aiello‐Lammens et al. 2015). This
is an approach based on the assumption that oversampled grid cells contribute little more than bias, rather than
strengthing any environmental responses.
This function provides some methods to apply spatial thinning approaches. Note that this effectively removes
data prior to any estimation and its use should be considered with care (see also Steen et al. 2021)."><meta property="og:image" content="https://iiasa.github.io/ibis.iSDM/logo.svg"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@Martin_Ecology"><meta name="twitter:site" content="@IIASAVienna"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ibis.iSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_train_simple_model.html">1. Train a model</a>
    <a class="dropdown-item" href="../articles/02_integrate_data.html">2. Integrate data</a>
    <a class="dropdown-item" href="../articles/03_biodiversity_projections.html">3. Biodiversity projections</a>
    <a class="dropdown-item" href="../articles/04_engine_comparison.html">4. Engine comparison</a>
    <a class="dropdown-item" href="../articles/05_package_comparison.html">5. Other packages</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/frequently-asked-questions.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/contributing.html">Contributing</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/iiasa/ibis.iSDM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Functionality for geographic and environmental thinning</h1>
      <small class="dont-index">Source: <a href="https://github.com/iiasa/ibis.iSDM/blob/HEAD/R/utils-spatial.R" class="external-link"><code>R/utils-spatial.R</code></a></small>
      <div class="d-none name"><code>thin_observations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For most species distribution modelling approaches it is assumed that occurrence records are unbiased, which
is rarely the case. While model-based control can alleviate some of the effects of sampling bias, it can often be
desirable to account for some sampling biases through spatial thinning (Aiello‐Lammens et al. 2015). This
is an approach based on the assumption that oversampled grid cells contribute little more than bias, rather than
strengthing any environmental responses.
This function provides some methods to apply spatial thinning approaches. Note that this effectively removes
data prior to any estimation and its use should be considered with care (see also Steen et al. 2021).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">thin_observations</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">background</span>,</span>
<span>  env <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  minpoints <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mindistance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zones <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>A <code>sf</code> or <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> object with observed occurrence points. All methods threat presence-only
and presence-absence occurrence points equally.</p></dd>


<dt>background</dt>
<dd><p>A <code>RasterLayer</code> object with the background of the study region. Use for assessing point density.</p></dd>


<dt>env</dt>
<dd><p>A <code>Raster</code> object with environmental covaraites. Needed when method is set to <code>"environmental"</code>
or <code>"bias"</code> (Default: <code>NULL</code>).</p></dd>


<dt>method</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> of the method to be applied (Default: <code>"random"</code>).</p></dd>


<dt>minpoints</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> giving the number of data points at minimum to take (Default: <code>10</code>).</p></dd>


<dt>mindistance</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> for the minimum distance of neighbouring observations (Default: <code>NULL</code>).</p></dd>


<dt>zones</dt>
<dd><p>A <code>RasterLayer</code> to be supplied when option <code>"method"</code> is chosen (Default: <code>NULL</code>).</p></dd>


<dt>verbose</dt>
<dd><p><code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> of whether to print some statistics about the thinning outcome (Default: <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently implemented thinning methods:</p><ul><li><p><code>"random"</code>: Samples at random up to number of <code>"minpoints"</code> across all occupied grid cells.
Does not account for any spatial or environmental distance between observations.</p></li>
<li><p><code>"bias"</code>: This option removed explicitly points that are considered biased (parameter <code>"env"</code>) only.
Points are preferentially thinned from grid cells which are in the 25% most biased (larger values assumed greater bias)
and have high point density. Thins the observations up to <code>"minpoints"</code>.</p></li>
<li><p><code>"zones"</code>: Assesses for each observation that it falls with a maximum of <code>"minpoints"</code> into
each occupied zone. Careful: If the zones are relatively wide this can remove quite a few observations.</p></li>
<li><p><code>"environmental"</code>: This approach creates an observation-wide clustering (k-means) under the assumption
that the full environmental niche has been comprehensively sampled and is covered by the provided covariates <code>env</code>.
We then obtain an number equal to (<code>"minpoints"</code>) of observations for each cluster.</p></li>
<li><p><code>"spatial"</code>: Calculates the spatial distance between all observations. Then points are removed
iteratively until the minimum distance between points is crossed.  The <code>"mindistance"</code> parameter has to
be set for this function to work.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Aiello‐Lammens, M. E., Boria, R. A., Radosavljevic, A., Vilela, B., &amp; Anderson, R. P. (2015). spThin: an R package for spatial thinning of species occurrence records for use in ecological niche models. Ecography, 38(5), 541-545.</p></li>
<li><p>Steen, V. A., Tingley, M. W., Paton, P. W., &amp; Elphick, C. S. (2021). Spatial thinning and class balancing: Key choices lead to variation in the performance of species distribution models with citizen science data. Methods in Ecology and Evolution, 12(2), 216-226.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Martin Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

