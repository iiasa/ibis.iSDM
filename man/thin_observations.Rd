% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-spatial.R
\name{thin_observations}
\alias{thin_observations}
\title{Functionality for geographic and environmental thinning}
\usage{
thin_observations(
  data,
  background,
  env = NULL,
  method = "random",
  remainpoints = 10,
  mindistance = NULL,
  zones = NULL,
  probs = 0.75,
  global = TRUE,
  centers = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A \code{\link{sf}} object with observed occurrence points. All methods threat
presence-only and presence-absence occurrence points equally.}

\item{background}{A \code{\link{SpatRaster}} object with the background of the study
region. Use for assessing point density.}

\item{env}{A \code{\link{SpatRaster}} object with environmental covariates. Needed when
method is set to \code{"environmental"} or \code{"bias"} (Default: \code{NULL}).}

\item{method}{A \code{\link{character}} of the method to be applied (Default: \code{"random"}).}

\item{remainpoints}{A \code{\link{numeric}} giving the number of data points at minimum to
remain (Default: \code{10}).}

\item{mindistance}{A \code{\link{numeric}} for the minimum distance of neighbouring observations
(Default: \code{NULL}).}

\item{zones}{A \code{\link{SpatRaster}} to be supplied when option \code{"zones"} is chosen
(Default: \code{NULL}).}

\item{probs}{A \code{\link{numeric}} used as quantile threshold in \code{"bias"} method.
(Default: \code{0.75}).}

\item{global}{A \code{\link{logical}} if during \code{"bias"} method global (entire \code{env} raster)
or local (extracted at point locations) bias values are used as for quantile threshold.
(Default: \code{TRUE}).}

\item{centers}{A \code{\link{numeric}} used as number of centers for \code{"environmental"} method.
(Default: \code{NULL}). If not set, automatically set to three or nlayers - 1
(whatever is bigger).}

\item{verbose}{\code{\link{logical}} of whether to print some statistics about the thinning
outcome (Default: \code{TRUE}).}
}
\description{
For most species distribution modelling approaches it is assumed
that occurrence records are unbiased, which is rarely the case. While
model-based control can alleviate some of the effects of sampling bias, it
can often be desirable to account for some sampling biases through spatial
thinning (Aiello‐Lammens et al. 2015). This is an approach based on the
assumption that over-sampled grid cells contribute little more than bias,
rather than strengthening any environmental responses. This function provides
some methods to apply spatial thinning approaches. Note that this
effectively removes data prior to any estimation and its use should be
considered with care (see also Steen et al. 2021).
}
\details{
All methods only remove points from "over-sampled" grid cells/areas. These are
defined as all cells/areas which either have more points than \code{remainpoints} or
more points than the global minimum point count per cell/area (whichever is larger).

Currently implemented thinning methods:
\itemize{
\item \code{"random"}: Samples at random across all over-sampled grid cells returning
only \code{"remainpoints"} from over-sampled cells. Does not account for any
spatial or environmental distance between observations.
\item \code{"bias"}: This option removes explicitly points that are considered biased
only (based on \code{"env"}). Points are only thinned from grid cells which are
above the bias quantile (larger values equals greater bias). Thins the observations
returning \code{"remainpoints"} from each over-sampled and biased cell.
\item \code{"zones"}: Thins observations from each zone that is above the over-sampled
threshold and returns  \code{"remainpoints"} for each zone. Careful: If the
zones are relatively wide this can remove quite a few observations.
\item \code{"environmental"}: This approach creates an observation-wide clustering
(k-means) under the assumption that the full environmental niche has been comprehensively
sampled and is covered by the provided covariates \code{env}. For each over-sampled
cluster, we then obtain (\code{"remainpoints"}) by thinning points.
\item \code{"spatial"}: Calculates the spatial distance between all observations.
Then points are removed iteratively until the minimum distance between points
is crossed. The \code{"mindistance"} parameter has to be set for this function to work.
}
}
\examples{
\dontrun{
 # Thin a certain number of observations
 # At random
 thin_points <- thin_observations(points, background, method = "random")
 # using a bias layer
 thin_points <- thin_observations(points, background, method = "bias", env = bias)
}

}
\references{
\itemize{
\item Aiello‐Lammens, M. E., Boria, R. A., Radosavljevic, A., Vilela, B., &
Anderson, R. P. (2015). spThin: an R package for spatial thinning of species
occurrence records for use in ecological niche models. Ecography, 38(5), 541-545.
\item Steen, V. A., Tingley, M. W., Paton, P. W., & Elphick, C. S. (2021). Spatial
thinning and class balancing: Key choices lead to variation in the performance
of species distribution models with citizen science data. Methods in Ecology and
Evolution, 12(2), 216-226.
}
}
\keyword{utils}
